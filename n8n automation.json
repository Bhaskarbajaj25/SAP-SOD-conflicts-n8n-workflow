{
  "name": "TCode Project",
  "nodes": [
    {
      "parameters": {
        "content": "SAP SOD LATEST",
        "height": 352,
        "width": 150
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        160,
        384
      ],
      "typeVersion": 1,
      "id": "467ba3c0-5915-42bf-af17-8d3757867f99",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": "",
          "mode": "list",
          "cachedResultName": "",
          "cachedResultUrl": ""
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        864,
        352
      ],
      "id": "95314189-aeff-49a5-9d6b-c8569c890ade",
      "name": "TCode - Sap Hana (Rules)4",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "1tmGiIj7He42ThBt",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "formTitle": "Upload SAP User Data",
        "formFields": {
          "values": [
            {
              "fieldLabel": "SAP_USER_DATA",
              "fieldType": "file",
              "acceptFileTypes": ".xlsx, .xls"
            },
            {
              "fieldLabel": "Send to"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        464,
        -16
      ],
      "id": "b87c2761-cf97-4608-9bd9-83978d8551d6",
      "name": "On Form Submission4",
      "webhookId": "fe02ce4a-f746-4681-b3ec-57bd8ff71c44"
    },
    {
      "parameters": {
        "binaryPropertyName": "SAP_USER_DATA",
        "options": {}
      },
      "type": "n8n-nodes-base.spreadsheetFile",
      "typeVersion": 2,
      "position": [
        752,
        736
      ],
      "id": "45db4388-c861-4192-9873-1475b77bafc8",
      "name": "Read Excel File4"
    },
    {
      "parameters": {
        "jsCode": "// 1. Get the input data (the rows from your Excel file)\nconst inputData = $items().map(item => item.json);\n\n// 2. Group the data by 'User Name' and then by 'Role Name'\nconst groupedByUser = {};\n\nfor (const row of inputData) {\n  const userName = row['User Name'];\n  const roleName = row['Role Name'];\n  const tCode = row['T.Code'];\n\n  // If the user doesn't exist yet, create an entry for them\n  if (!groupedByUser[userName]) {\n    groupedByUser[userName] = {\n      roles: {}\n    };\n  }\n\n  // If the role for this user doesn't exist, create it\n  if (!groupedByUser[userName].roles[roleName]) {\n    groupedByUser[userName].roles[roleName] = [];\n  }\n\n  // Add the T-Code to the correct role\n  groupedByUser[userName].roles[roleName].push(tCode);\n}\n\n// 3. Format the grouped data into the final desired structure\nconst finalOutput = [];\n\nfor (const userName in groupedByUser) {\n  const user = groupedByUser[userName];\n  for (const roleName in user.roles) {\n    const tCodes = user.roles[roleName];\n\n    // Join T-Codes, remove duplicates, sort them, and make them uppercase\n    const allTCodesString = [...new Set(tCodes)]\n      .filter(tc => typeof tc === 'string' && tc.trim() !== '')\n      .map(tc => tc.trim().toUpperCase())\n      .sort()\n      .join(', ');\n\n    finalOutput.push({\n      'User Name': userName,\n      'Role Name': roleName,\n      'All_T-codes': allTCodesString\n    });\n  }\n}\n\n// 4. Return the final result as a single n8n item\n// This makes it easy for the next node to use.\nreturn [{ json: { data: finalOutput } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1024,
        736
      ],
      "id": "b3e38912-d95c-4f1a-ab13-331415ddbd42",
      "name": "Code: Transform Data8"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "cdc26438-d973-42a2-b6e2-1e574397e94d",
              "name": "rule",
              "value": "={{ $items().map(item => item.json) }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1280,
        352
      ],
      "id": "07156aaa-61cf-4faa-9efe-ef64a31467a0",
      "name": "Set - Wrap Rules8"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "986d510e-c6d0-43b6-ba59-09da2ad6f4a9",
              "name": "users",
              "value": "={{ $items().map(item => item.json) }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1280,
        736
      ],
      "id": "4df078e7-a11e-466a-8ee8-3d04c1f66df4",
      "name": "Set - Wrap Users8"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        1536,
        528
      ],
      "id": "aef4457b-d10c-4f1a-8210-ed7e313c3a46",
      "name": "Merge8"
    },
    {
      "parameters": {
        "jsCode": "// 1ï¸âƒ£ Get all rows from the Excel input\nconst inputData = $items().map(item => item.json);\n\n// 2ï¸âƒ£ Prepare the output array\nconst finalOutput = [];\n\nfor (const row of inputData) {\n  const rowNumber = row['row_number'];\n  const sNo = row['S.No'];\n  const ruleSet = row['Rule Set'];\n  const ap1 = row['Access Point 1 T-codes'];\n  const ap2 = row['Access Point 2 T-codes'];\n\n  // ðŸ§¹ Clean, uppercase, deduplicate, and sort Access Point 1\n  const ap1Codes = (typeof ap1 === 'string' && ap1.trim() !== '')\n    ? [...new Set(ap1.split(',').map(tc => tc.trim().toUpperCase()))].sort().join(', ')\n    : '';\n\n  // ðŸ§¹ Clean, uppercase, deduplicate, and sort Access Point 2\n  const ap2Codes = (typeof ap2 === 'string' && ap2.trim() !== '')\n    ? [...new Set(ap2.split(',').map(tc => tc.trim().toUpperCase()))].sort().join(', ')\n    : '';\n\n  // âœ… Push cleaned data as a structured row\n  finalOutput.push({\n    'row_number': rowNumber,\n    'S.No': sNo,\n    'Rule Set': ruleSet,\n    'Access Point 1 T-codes': ap1Codes,\n    'Access Point 2 T-codes': ap2Codes\n  });\n}\n\n// 3ï¸âƒ£ Return each row as a separate n8n item\nreturn [{ json: { data: finalOutput } }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1056,
        352
      ],
      "id": "b5c05915-cfc8-4323-a83c-0051ea946fda",
      "name": "Code: Transform Data9"
    },
    {
      "parameters": {
        "jsCode": "// âœ… Step 1: Extract and safely parse input\nconst inputItem = $input.first().json;\n\n// Extract raw rule and user data\nlet rulesRaw = inputItem.rule || inputItem.rules; // handle both 'rule' or 'rules'\nlet usersRaw = inputItem.users;\n\n// ##########################################################################\n// ðŸ§© Parse RULES safely\n// ##########################################################################\nlet rules = [];\ntry {\n  const parsedRules = typeof rulesRaw === 'string' ? JSON.parse(rulesRaw) : rulesRaw;\n\n  if (Array.isArray(parsedRules)) {\n    if (parsedRules[0]?.data && Array.isArray(parsedRules[0].data)) {\n      rules = parsedRules[0].data;\n    } else if (parsedRules[0]?.[\"Rule Set\"]) {\n      rules = parsedRules;\n    } else if (Array.isArray(parsedRules[0])) {\n      rules = parsedRules[0];\n    }\n  }\n} catch (err) {\n  return [{ json: { error: \"âŒ Failed to parse rules JSON\", details: err.message, raw: rulesRaw } }];\n}\n\n// ##########################################################################\n// ðŸ§© Parse USERS safely\n// ##########################################################################\nlet users = [];\ntry {\n  const parsedUsers = typeof usersRaw === 'string' ? JSON.parse(usersRaw) : usersRaw;\n\n  if (Array.isArray(parsedUsers)) {\n    if (parsedUsers[0]?.data && Array.isArray(parsedUsers[0].data)) {\n      users = parsedUsers[0].data;\n    } else if (parsedUsers[0]?.[\"User Name\"]) {\n      users = parsedUsers;\n    }\n  }\n} catch (err) {\n  return [{ json: { error: \"âŒ Failed to parse users JSON\", details: err.message, raw: usersRaw } }];\n}\n\n// ##########################################################################\n// ðŸ§¾ Validation\n// ##########################################################################\nif (!Array.isArray(rules) || rules.length === 0) {\n  return [{ json: { error: \"âŒ No valid rules found\", received: rulesRaw } }];\n}\nif (!Array.isArray(users) || users.length === 0) {\n  return [{ json: { error: \"âŒ No valid users found\", received: usersRaw } }];\n}\n\n// ##########################################################################\n// ðŸ‘¥ Group users by user name (multi-role handling)\n// ##########################################################################\nconst usersGrouped = {};\n\nfor (const user of users) {\n  const userName = user[\"User Name\"] || \"Unnamed User\";\n  const roleName = user[\"Role Name\"] || \"Unnamed Role\";\n  const tcodeString = user[\"All_T-codes\"] || \"\";\n\n  if (!tcodeString.trim()) continue;\n\n  const roleTcodes = tcodeString\n    .split(\",\")\n    .map(tc => tc.trim().toUpperCase())\n    .filter(tc => tc);\n\n  if (!usersGrouped[userName]) {\n    usersGrouped[userName] = { roles: [] };\n  }\n\n  usersGrouped[userName].roles.push({ roleName, tcodes: roleTcodes });\n}\n\nconst results = [];\n\n// ##########################################################################\n// ðŸŸ¥ INTRA-ROLE (within same role)\n// ##########################################################################\nfor (const userName in usersGrouped) {\n  for (const role of usersGrouped[userName].roles) {\n    for (const rule of rules) {\n      const ap1 = (rule[\"Access Point 1 T-codes\"] || \"\")\n        .split(\",\")\n        .map(tc => tc.trim().toUpperCase())\n        .filter(tc => tc);\n      const ap2 = (rule[\"Access Point 2 T-codes\"] || \"\")\n        .split(\",\")\n        .map(tc => tc.trim().toUpperCase())\n        .filter(tc => tc);\n\n      const hasAP1 = ap1.some(tc => role.tcodes.includes(tc));\n      const hasAP2 = ap2.some(tc => role.tcodes.includes(tc));\n\n      if (hasAP1 && hasAP2) {\n        results.push({\n          json: {\n            \"User Name\": userName,\n            \"Role Name\": role.roleName,\n            \"Conflict Type\": \"ðŸŸ¥ Intra-Role\",\n            \"Rule No\": rule[\"S.No\"] || \"\",\n            \"Rule Description\": rule[\"Rule Set\"] || \"\",\n            \"Access Point 1\": ap1.join(\", \"),\n            \"Access Point 2\": ap2.join(\", \"),\n            \"Matched T-codes\": [...ap1.filter(tc => role.tcodes.includes(tc)), ...ap2.filter(tc => role.tcodes.includes(tc))].join(\", \")\n          }\n        });\n      }\n    }\n  }\n}\n\n// ##########################################################################\n// âœ… Return results or summary\n// ##########################################################################\nif (results.length === 0) {\n  return [{\n    json: {\n      message: \"âœ… No Intra-Role SoD violations found\",\n      stats: {\n        usersProcessed: Object.keys(usersGrouped).length,\n        rolesProcessed: users.length,\n        rulesProcessed: rules.length\n      }\n    }\n  }];\n}\n\nreturn results;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1824,
        320
      ],
      "id": "a3c5d702-c388-487a-89df-8792b016b06f",
      "name": "Function - Analyze Intra role2"
    },
    {
      "parameters": {
        "jsCode": "// === Get and Parse Input ===\nconst inputItem = $input.first().json;\n\nlet rules = inputItem.rule;\nlet users = inputItem.users;\n\nif (typeof rules === 'string') rules = JSON.parse(rules);\nif (typeof users === 'string') users = JSON.parse(users);\n\nrules = Array.isArray(rules) && rules[0]?.data ? rules[0].data : rules;\nusers = Array.isArray(users) && users[0]?.data ? users[0].data : users;\n\nif (!Array.isArray(rules) || !Array.isArray(users)) {\n    return [{ json: { message: \"Invalid input format\" } }];\n}\n\n// === Normalize helper ===\nfunction normalizeTcodes(str) {\n    if (!str) return [];\n    return [...new Set(\n        str\n            .toString()\n            .replace(/[^\\x00-\\x7F]/g, '') // remove hidden chars\n            .split(/[,;\\/\\s]+/)\n            .map(tc => tc.trim().toUpperCase())\n            .filter(tc => tc)\n    )];\n}\n\n// === Step 1: Group user roles and tcodes ===\nconst usersGrouped = {};\nfor (const u of users) {\n    const user = (u[\"User Name\"] || \"\").trim();\n    const role = (u[\"Role Name\"] || \"\").trim();\n    if (!user || !role) continue;\n\n    const tcodes = normalizeTcodes(u[\"All_T-codes\"]);\n    if (!tcodes.length) continue;\n\n    if (!usersGrouped[user]) usersGrouped[user] = {};\n    usersGrouped[user][role] = tcodes;\n}\n\n// === Step 2: Detect all Inter-Role conflicts per rule ===\nconst results = [];\n\nfor (const user in usersGrouped) {\n    const roleNames = Object.keys(usersGrouped[user]);\n    if (roleNames.length < 2) continue;\n\n    for (const rule of rules) {\n        const ruleNo = rule[\"S.No\"] || \"\";\n        const ruleDesc = rule[\"Rule Set\"] || rule[\"Rule Description\"] || \"\";\n        const ap1 = normalizeTcodes(rule[\"Access Point 1 T-codes\"]);\n        const ap2 = normalizeTcodes(rule[\"Access Point 2 T-codes\"]);\n        if (!ap1.length || !ap2.length) continue;\n\n        // find roles matching each access point\n        const rolesAP1 = {};\n        const rolesAP2 = {};\n        for (const r of roleNames) {\n            const tcodes = usersGrouped[user][r];\n            const match1 = ap1.filter(tc => tcodes.includes(tc));\n            const match2 = ap2.filter(tc => tcodes.includes(tc));\n            if (match1.length) rolesAP1[r] = match1;\n            if (match2.length) rolesAP2[r] = match2;\n        }\n\n        // now compare every role in AP1 vs AP2\n        for (const r1 in rolesAP1) {\n            for (const r2 in rolesAP2) {\n                if (r1 === r2) continue; // inter-role only\n                for (const tc1 of rolesAP1[r1]) {\n                    for (const tc2 of rolesAP2[r2]) {\n                        results.push({\n                            json: {\n                                \"User\": user,\n                                \"Rule No\": ruleNo,\n                                \"Rule Description\": ruleDesc,\n                                \"Roles Involved\": `${r1} â†” ${r2}`,\n                                \"Matched T-codes\": `${tc1} (${r1}), ${tc2} (${r2})`,\n                                \"Conflict Type\": \"Inter-Role\"\n                            }\n                        });\n                    }\n                }\n            }\n        }\n    }\n}\n\nreturn results.length ? results : [{ json: { message: \"No SoD conflicts found\" } }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1824,
        720
      ],
      "id": "b0b5803f-01e9-4886-bc4c-ee58477b3346",
      "name": "Function - Analyze Inter role2"
    },
    {
      "parameters": {
        "operation": "xlsx",
        "binaryPropertyName": "Inter role conflict",
        "options": {
          "fileName": "Inter role conflicts"
        }
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        2032,
        720
      ],
      "id": "6b21bf46-100c-4e05-8b71-16a85652f55a",
      "name": "Inter role data to File5"
    },
    {
      "parameters": {
        "operation": "xlsx",
        "binaryPropertyName": "Intra role conflict",
        "options": {
          "fileName": "Intra Role conflicts"
        }
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        2048,
        320
      ],
      "id": "bcac7cc8-bc45-42df-a818-00dbc74acc93",
      "name": "Intra role to File4"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        2304,
        512
      ],
      "id": "aa1f1abf-a570-40f9-b4b6-69ccee510304",
      "name": "Merge for Email"
    },
    {
      "parameters": {
        "sendTo": "={{ $json[\"Send to\"] }}",
        "subject": "=ðŸš¨ SoD Violation Report ",
        "message": "={{\n(() => {\n  // --- Get recipient email ---\n  const to = $json[\"Send to\"] || \"\";\n  let email = Array.isArray(to) ? to[0] : to;\n  email = (email || \"\").trim();\n\n  // --- Extract name from email ---\n  let namePart = email.split(\"@\")[0] || \"\";\n  namePart = namePart.replace(/^[a-z]-/, \"\"); // remove prefixes like m-\n  const firstNameRaw = namePart.split(/[.\\d_-]/)[0] || \"there\";\n  const firstName = firstNameRaw.charAt(0).toUpperCase() + firstNameRaw.slice(1);\n\n  // --- Count items from exact node names ---\n  const intraCount = $items(\"Function - Analyze Intra role2\").length || 0;\n  const interCount = $items(\"Function - Analyze Inter role2\").length || 0;\n  const totalCount = intraCount + interCount;\n\n  // --- HTML email ---\n  return `\n  <p>Hi Team,</p>\n\n  <p>Please find attached the latest <b>SoD violation reports</b>:</p>\n\n  <ul>\n    <li>Intra-Role Conflicts</li>\n    <li>Inter-Role Conflicts</li>\n  </ul>\n\n  <p><b>Summary:</b></p>\n  <table border=\"1\" cellpadding=\"6\" cellspacing=\"0\" style=\"border-collapse:collapse; font-family:Arial; font-size:13px;\">\n    <tr style=\"background:#f2f2f2; font-weight:bold;\">\n      <td>Conflict Type</td><td>Count</td>\n    </tr>\n    <tr><td>Intra-Role Conflicts</td><td>${intraCount}</td></tr>\n    <tr><td>Inter-Role Conflicts</td><td>${interCount}</td></tr>\n    <tr style=\"background:#e6f7ff; font-weight:bold;\">\n      <td>Total Violations</td><td>${totalCount}</td></tr>\n  </table>\n\n  <br/>\n  <p>Best regards,<br/>Infosec IT Audit Team</p>\n  `;\n})()\n}}\n",
        "options": {
          "attachmentsUi": {
            "attachmentsBinary": [
              {
                "property": "Intra role conflict"
              },
              {
                "property": "Inter role conflict"
              }
            ]
          }
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        2960,
        -16
      ],
      "id": "012d1b8d-8b3d-4a5b-9e81-c911d829aae7",
      "name": "Send Security Report4",
      "webhookId": "ecc99210-a15b-4dcb-8689-c289259d6bbb",
      "credentials": {
        "gmailOAuth2": {
          "id": "0XLXlt1Y0qaSeCBK",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// âœ… Get conflict data from the two file nodes\nconst intraItems = $('Intra role to File4').all();   // Reads from the Intra role conflict file\nconst interItems = $('Inter role data to File5').all(); // Reads from the Inter role conflict file\n\n// âœ… Count conflicts\nconst intraCount = intraItems.length || 0;\nconst interCount = interItems.length || 0;\nconst totalCount = intraCount + interCount;\n\n// âœ… Extract recipient email from form submission\nconst email = $json[\"Send to\"] || $json[\"to\"] || \"team@company.com\";\n\n// Extract name for personalization\nlet firstName = \"Team\";\nif (email && typeof email === \"string\") {\n  const raw = email.split(\"@\")[0].split(/[._-]/).find(Boolean);\n  if (raw) {\n    firstName = raw.charAt(0).toUpperCase() + raw.slice(1).toLowerCase();\n  }\n}\n\n// âœ… Build the HTML email body\nconst htmlBody = `\n<p>Hello ${firstName},</p>\n\n<p>Please find attached the latest <b>SoD Violation Reports</b>:</p>\n<ul>\n  <li>Intra-Role Conflicts</li>\n  <li>Inter-Role Conflicts</li>\n</ul>\n\n<p><b>Summary:</b></p>\n<table border=\"1\" cellpadding=\"6\" cellspacing=\"0\" style=\"border-collapse:collapse; font-family:Arial, sans-serif; font-size:14px;\">\n  <tr style=\"background-color:#f2f2f2;\">\n    <th align=\"left\">Conflict Type</th>\n    <th align=\"right\">Count</th>\n  </tr>\n  <tr><td>Intra-Role Conflicts</td><td align=\"right\">${intraCount}</td></tr>\n  <tr><td>Inter-Role Conflicts</td><td align=\"right\">${interCount}</td></tr>\n  <tr><td><b>Total Violations</b></td><td align=\"right\"><b>${totalCount}</b></td></tr>\n</table>\n\n<p>Best regards,<br><b>Infosec IT Audit Team</b></p>\n`;\n\n// âœ… Return prepared mail object with attachments\nreturn [\n  {\n    json: {\n      to: email,\n      subject: `SoD Conflict Summary â€“ ${firstName}`,\n      htmlBody,\n      intraCount,\n      interCount,\n      totalCount,\n    },\n    binary: $binary, // preserve both Excel attachments\n  },\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2496,
        224
      ],
      "id": "49ee7f71-de16-433f-b328-4a8b41f09777",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        2640,
        -16
      ],
      "id": "8ef377a8-e25d-4bf2-b255-023047c90466",
      "name": "Merge1"
    }
  ],
  "pinData": {},
  "connections": {
    "TCode - Sap Hana (Rules)4": {
      "main": [
        [
          {
            "node": "Code: Transform Data9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "On Form Submission4": {
      "main": [
        [
          {
            "node": "TCode - Sap Hana (Rules)4",
            "type": "main",
            "index": 0
          },
          {
            "node": "Read Excel File4",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read Excel File4": {
      "main": [
        [
          {
            "node": "Code: Transform Data8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code: Transform Data8": {
      "main": [
        [
          {
            "node": "Set - Wrap Users8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set - Wrap Rules8": {
      "main": [
        [
          {
            "node": "Merge8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set - Wrap Users8": {
      "main": [
        [
          {
            "node": "Merge8",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Merge8": {
      "main": [
        [
          {
            "node": "Function - Analyze Intra role2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Function - Analyze Inter role2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code: Transform Data9": {
      "main": [
        [
          {
            "node": "Set - Wrap Rules8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Function - Analyze Intra role2": {
      "main": [
        [
          {
            "node": "Intra role to File4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Function - Analyze Inter role2": {
      "main": [
        [
          {
            "node": "Inter role data to File5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Intra role to File4": {
      "main": [
        [
          {
            "node": "Merge for Email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Inter role data to File5": {
      "main": [
        [
          {
            "node": "Merge for Email",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Merge for Email": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Merge1": {
      "main": [
        [
          {
            "node": "Send Security Report4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "versionId": "91a061e5-5df8-4f61-84a8-d24225af7403",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "5b080a24b4e1df83184ae370c1f0c3ef7d6a782b115e78b6e075f9faf1de99d4"
  },
  "id": "xmLcnK-u9DnlO9ul2_m8w",
  "tags": []
}